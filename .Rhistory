Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_samples
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
View(Daniel_cell_densities)
View(Daniel_sample)
View(comparison)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
View(comparison)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
View(comparison)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == FALSE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE) %>%
group_by(celltypes)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
View(Daniel_sample)
View(comparison)
View(IMC)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
View(comparison)
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = random_sample
comparison = rbind(Daniel_sample, comparison)
mean(IMC$celltypes)
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise()
View(IMC)
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = FALSE)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = "drop")
View(ROI_mean)
ROI_mean = t(ROI_mean)
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = as.matrix(t(ROI_mean))
ROI_mean = as.data.frame(t(ROI_mean))
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1,drop=FALSE]
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison2 = rbind(Daniel_sample, ROI_mean)
View(comparison2)
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = mean(count), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison2 = rbind(Daniel_sample, ROI_mean)
View(comparison2)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
## option 1: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison1 = rbind(Daniel_sample, comparison)
View(comparison1)
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison2 = rbind(Daniel_sample, ROI_mean)
View(comparison2)
## option 1: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison1 = rbind(Daniel_sample, comparison)
## option 1: sum, only tumor
IMC = read.csv(filenames, header = TRUE) #%>%
#filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison1 = rbind(Daniel_sample, comparison)
View(comparison1)
View(IMC)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
## option 1: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison1 = rbind(Daniel_sample, comparison)
## option 2: sum, only tumor
IMC = read.csv(filenames, header = TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison2 = rbind(Daniel_sample, comparison)
## option 3: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == FALSE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison3 = rbind(Daniel_sample, comparison)
## option 4: average, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison4 = rbind(Daniel_sample, ROI_mean)
View(comparison1)
View(comparison2)
View(comparison3)
View(comparison4)
## option 1: sum, every patch
IMC = read.csv(filenames, header = TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_all_patches")
comparison1 = rbind(Daniel_sample, comparison)
## option 2: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison2 = rbind(Daniel_sample, comparison)
## option 3: sum, only stroma
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == FALSE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_stroma")
comparison3 = rbind(Daniel_sample, comparison)
## option 4: average
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison4 = rbind(Daniel_sample, ROI_mean)
View(comparison1)
View(comparison2)
View(comparison3)
View(comparison4)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
## option 1: sum, every patch
IMC = read.csv(filenames, header = TRUE)
unique(IMC$celltypes)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
## option 1: sum, every patch
IMC = read.csv(filenames, header = TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_all_patches")
comparison1 = rbind(Daniel_sample, comparison)
## option 2: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison2 = rbind(Daniel_sample, comparison)
library(dplyr)
library(tibble)
Daniel_cell_densities = read.csv("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC2/01_Imaging_Daniel/IMC_cell_type_densities.csv", header = TRUE)
random_sample = Daniel_cell_densities[sample(nrow(Daniel_cell_densities), 1),"immucan_id"]
filenames <- list.files("../IMMUCAN_data/NSCLC2/01_Imaging/IMC/single_file_for_patient", pattern=random_sample, full.names=TRUE)
## option 1: sum, every patch
IMC = read.csv(filenames, header = TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_all_patches")
comparison1 = rbind(Daniel_sample, comparison)
## option 2: sum, only tumor
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == TRUE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_tumor")
comparison2 = rbind(Daniel_sample, comparison)
## option 3: sum, only stroma
IMC = read.csv(filenames, header = TRUE) %>%
filter(tumor_patches == FALSE)
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison <- data.frame(as.list(table(IMC$celltypes)))
rownames(comparison) = paste0(random_sample, "_only_stroma")
comparison3 = rbind(Daniel_sample, comparison)
## option 4: average
IMC = read.csv(filenames, header = TRUE) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison4 = rbind(Daniel_sample, ROI_mean)
IMC = read.csv(filenames, header = TRUE)
## option 3: sum, only stroma
IMC = read.csv(filenames, header = TRUE) %>%
filter(ROI != 4)
## option 5: 1,2,3 ROIs average
IMC = read.csv(filenames, header = TRUE) %>%
filter(ROI != 4)
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
IMC = read.csv(filenames, header = TRUE) %>%
filter(ROI != 4)
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
IMC$ROI
library(dplyr)
library(tibble)
## option 5: 1,2,3 ROIs average
IMC = read.csv(filenames, header = TRUE) %>%
dplyr::filter(ROI != 4)
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
## option 5: 1,2,3 ROIs average
IMC = read.csv(filenames, header = TRUE) %>%
filter(ROI != 4) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
ROI_mean = as.data.frame(t(ROI_mean))
colnames(ROI_mean) = ROI_mean[1,]
ROI_mean = ROI_mean[-1, , drop=FALSE]
rownames(ROI_mean) = paste0(random_sample, "_", rownames(ROI_mean))
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
Daniel_sample = Daniel_sample[,-2] %>%
column_to_rownames("immucan_id")
rownames(Daniel_sample) = paste0(rownames(Daniel_sample), "_Daniel")
comparison5 = rbind(Daniel_sample, ROI_mean)
View(comparison5)
IMC = read.csv(filenames, header = TRUE) %>%
filter(ROI != 4) %>%
group_by(ROI, celltypes) %>%
summarise(count = n(), .groups = 'drop')
IMC2 = read.csv(filenames, header = TRUE) %>%
filter(ROI == 1) %>%
filter(celltypes == "B")
View(IMC2)
IMC2 = read.csv(filenames, header = TRUE) %>%
filter(ROI == 1) %>%
filter(celltypes == "B") %>%
select(celltypes, ROI)
IMC2 = read.csv(filenames, header = TRUE) %>%
filter(ROI == 3) %>%
filter(celltypes == "MacCD163") %>%
select(celltypes, ROI)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop")
View(ROI_mean)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop") %>%
column_to_rownames(celltypes)
View(ROI_mean)
View(ROI_mean)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop") %>%
column_to_rownames(celltypes)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop") %>%
column_to_rownames(celltypes)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop") %>%
column_to_rownames("celltypes")
Daniel_sample = filter(Daniel_cell_densities, immucan_id == random_sample)
View(Daniel_sample)
ROI_mean = IMC %>%
group_by(celltypes) %>%
summarise(ROI_average = round(mean(count), digits = 0), .groups = "drop") %>%
column_to_rownames("celltypes") %>%
pivot_wider()
