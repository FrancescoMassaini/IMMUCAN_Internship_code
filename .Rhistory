BC2_COUNTS <- read.table('/home/francesco.massaini/Desktop/IMMUCAN/BC2/BC2_COUNTS.txt', header = TRUE,  sep = '	', row.names = 1)
entrz <- AnnotationDbi::select(org.Hs.eg.db, keys = rownames(BC2_COUNTS), columns = "SYMBOL", keytype = "ENSEMBL")
library(org.Hs.eg.db)
entrz <- AnnotationDbi::select(org.Hs.eg.db, keys = rownames(BC2_COUNTS), columns = "SYMBOL", keytype = "ENSEMBL")
counts <- BC2_COUNTS %>%
data.frame() %>%
mutate(ENSEMBL = rownames(counts)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL") %>%
select(-ENSEMBL)
library(dplyr)
counts <- BC2_COUNTS %>%
data.frame() %>%
mutate(ENSEMBL = rownames(counts)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL") %>%
select(-ENSEMBL)
library(tibble)
library(org.Hs.eg.db)
library(dplyr)
library(tibble)
entrz <- AnnotationDbi::select(org.Hs.eg.db, keys = rownames(BC2_COUNTS), columns = "SYMBOL", keytype = "ENSEMBL")
counts <- BC2_COUNTS %>%
data.frame() %>%
mutate(ENSEMBL = rownames(counts)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL")
counts <- BC2_COUNTS %>%
data.frame() %>%
mutate(ENSEMBL = rownames(counts)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL")
counts <- BC2_COUNTS %>%
mutate(ENSEMBL = rownames(counts)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL")
View(entrz)
counts <- BC2_COUNTS %>%
mutate(ENSEMBL = rownames(BC2_COUNTS)) %>%
inner_join(., entrz, by="ENSEMBL") %>%
dplyr::filter(!is.na(SYMBOL)) %>%
distinct(SYMBOL, .keep_all = T) %>%
column_to_rownames("SYMBOL")
counts$ENSEMBL = NULL
library(ADImpute)
x = ADImpute::NormalizeTPM(counts, log = T)
sampleDists <- dist(t(counts)) #DO NOT DO IT FOR GENES
sampleDistMatrix <- as.matrix(sampleDists)
library(RColorBrewer)
sampleDistMatrix <- as.matrix(sampleDists)
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
library(pheatmap)
sampleDistMatrix <- as.matrix(sampleDists)
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
pheatmap(sampleDistMatrix,
clustering_distance_rows=sampleDists,
clustering_distance_cols=sampleDists,
col=colors)
sampleTree = hclust(dist(t(counts)), method = "average");
plot(sampleTree, main = "Sample clustering to detect outliers", sub="", xlab="", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2)
plot(sampleTree, main = "Sample clustering to detect outliers", sub="", xlab="", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2)
colum(org.Hs.eg.db)
column(org.Hs.eg.db)
columns(org.Hs.eg.db)
library(tidyverse)
library(tidyverse)
library(tibble)
library(org.Hs.eg.db) # Homo sapiens db
library(ADImpute) # to normalize with gene lenght
library(RColorBrewer) # for plot
library(pheatmap) # for heatmaps
library(ADImpute)
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
starwars
BC1 <- select(all, grep("BC1"))
library(tidyverse)
library(tibble)
library(org.Hs.eg.db) # Homo sapiens db
library(ADImpute) # to normalize with gene lenght
library(RColorBrewer) # for plot
library(pheatmap) # for heatmaps
library(ADImpute)
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1 <- select(all, grep("BC1"))
BC1 <- dplyr::select(all, grep("BC1"))
BC1 <- dplyr::select(all, grep(pattern = "BC1", x = all))
View(BC1)
BC1 <- dplyr::select(all, grep(pattern = "*.BC1*.", x = all))
BC1 <- dplyr::select(all, grep(pattern = "*.BC1.*", x = all))
BC1 <- dplyr::select(all, grep(pattern = ".*BC1.*", x = all))
BC1 <- grep(pattern = "BC1", all, value = T)
BC1 <- grep(pattern = "BC1", colnames(all), value = T)
BC3 <- grep(pattern = "BC3", colnames(all), value = T)
# dplyr::select(all, grep(pattern = ".*BC1.*", x = all))
BC1 <- df[BC1_samples]
BC1_samples <- grep(pattern = "BC1", colnames(all), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all), value = T)
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T)
BC1 <- df[BC1_samples]
BC1 <- all[BC1_samples]
View(BC1)
BC3 <- all[BC3_samples]
custom_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = 1)
custom_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = 0)
custom_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = 0)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = 0)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
View(custom_BC2_cohort_samples)
custom_BC2_cohort_samples[1]
unique(custom_BC2_cohort_samples[1])
?unique()
if (length(custom_BC2_cohort_samples[1]) == unique(custom_BC2_cohort_samples[1])){
print(TRUE)
}
length(custom_BC2_cohort_samples[1])
unique(custom_BC2_cohort_samples[1])
length(unique(custom_BC2_cohort_samples[1])
unique(custom_BC2_cohort_samples[1])
length(unique(custom_BC2_cohort_samples[1]))
nrow(custom_BC2_cohort_samples[1])
nrow(unique(custom_BC2_cohort_samples[1]))
if (nrow(custom_BC2_cohort_samples[1]) == nrow(unique(custom_BC2_cohort_samples[1]))){
message("Unique ha rimosso dei duplicati.")
} else {
message("Non sono stati trovati duplicati.")
}
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
if (nrow(custom_BC2_cohort_samples[1]) == nrow(unique(custom_BC2_cohort_samples[1]))){
message("Unique ha rimosso dei duplicati.")
} else {
message("Non sono stati trovati duplicati.")
}
custom_BC2_cohort_samples[1]
unique(custom_BC2_cohort_samples[1])
if (nrow(custom_BC2_cohort_samples[1]) == nrow(unique(custom_BC2_cohort_samples[1]))){
message("Non sono stati trovati duplicati.")
} else {
message("Unique ha rimosso dei duplicati.")
}
duplicated.default(custom_BC2_cohort_samples[1])
custom_BC2_cohort_samples[1]
setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
library(BiocGenerics)
setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
nrow(unique(custom_BC2_cohort_samples[1]))
nrow(custom_BC2_cohort_samples[1])
nrow(custom_BC2_cohort_samples[1])
unique(custom_BC2_cohort_samples[1])
setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL) %>%
setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
BC1_samples <- grep(pattern = "BC1", colnames(all), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all), value = T)
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(BC2_samples, custom_BC2_cohort_samples)
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(, custom_BC2_cohort_samples)
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(., custom_BC2_cohort_samples)
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(., custom_BC2_cohort_samples)
View(all)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
mutate_all(str_replace_all("-","."))
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
mutate_all(str_replace_all, "-",".")
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) #%>%
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) #%>%
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
str_replace_all("-",".")
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
%>%
View(custom_BC2_cohort_samples)
library(tidyverse)
library(tibble)
library(org.Hs.eg.db) # Homo sapiens db
library(ADImpute) # to normalize with gene lenght
library(RColorBrewer) # for plot
library(pheatmap) # for heatmaps
library(ADImpute)
library(BiocGenerics)
library(stringr)
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
str_replace_all("-",".")
BC1_samples <- grep(pattern = "BC1", colnames(all), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all), value = T)
str(custom_BC2_cohort_samples)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
str(custom_BC2_cohort_samples)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
str(custom_BC2_cohort_samples)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
as.array()
custom_BC2_cohort_samples <- as.array(setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])))
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- as.array(setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])))
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
str(custom_BC2_cohort_samples)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples_2 <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1])) %>%
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
library(tidyverse)
library(tibble)
library(org.Hs.eg.db) # Homo sapiens db
library(ADImpute) # to normalize with gene lenght
library(RColorBrewer) # for plot
library(pheatmap) # for heatmaps
library(ADImpute)
library(BiocGenerics)
library(stringr)
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples_2 <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
custom_BC2_cohort_samples_2 <- custom_BC2_cohort_samples[1]
custom_BC2_cohort_samples_2 <- custom_BC2_cohort_samples$sample
str(custom_BC2_cohort_samples_2)
custom_BC2_cohort_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_cohort_samples_2 <- setdiff(custom_BC2_cohort_samples[1],unique(custom_BC2_cohort_samples[1]))
View(custom_BC2_cohort_samples)
View(custom_BC2_cohort_samples_2)
library(tidyverse)
library(tibble)
library(org.Hs.eg.db) # Homo sapiens db
library(ADImpute) # to normalize with gene lenght
library(RColorBrewer) # for plot
library(pheatmap) # for heatmaps
library(ADImpute)
library(BiocGenerics)
library(stringr)
all <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- setdiff(custom_BC2_samples[1],unique(custom_BC2_samples[1])) %>%
custom_BC2_samples_unique$sample
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- setdiff(custom_BC2_samples[1],unique(custom_BC2_samples[1])) %>%
custom_BC2_samples_unique$
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
custom_BC2_samples_unique$sample
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
select(1)
str(unique(custom_BC2_samples[1]))
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
dplyr::select(1)
str(custom_BC2_samples_unique)
View(custom_BC2_samples_unique)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
str_replace_all("-",".")
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".")
View(custom_BC2_samples_unique)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", paste0("RNA.01"))
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", paste0(.,"RNA.01"))
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", ~paste0(.,"RNA.01"))
View(custom_BC2_samples_unique)
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", ~paste0(.,".RNA.01"))
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(., custom_BC2_cohort_samples)
grep(pattern = "BC2", colnames(all), value = T)
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(., custom_BC2_samples_unique)
custom_BC2_samples_unique
custom_BC2_samples_unique <- unique(custom_BC2_samples[1]) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", ~paste0(.,".RNA.01")) %>%
as.vector()
View(custom_BC2_samples_unique)
as.vector(custom_BC2_samples_unique)
as.vector(as.factor(custom_BC2_samples_unique))
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>%
mutate_at("sample", str_replace_all, "-",".") %>%
mutate_at("sample", ~paste0(.,".RNA.01"))
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>%
str_replace_all("-",".") %>%
paste0(.,".RNA.01")
custom_BC2_samples_unique
# BC2 needs to be filtered with custom patients
BC2_samples <- grep(pattern = "BC2", colnames(all), value = T) %>%
intersect(., custom_BC2_samples_unique)
BC2 <- all[BC2_samples]
View(BC2)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs_BCs <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all_BCs("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all_BCs
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "BC1_TPM_Mounim", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
getwd()
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "BC2_TPM_Mounim", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "BC3_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "BC2_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "BC3_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/all_BCs_merged_BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC1/02_TPM/BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/02_TPM/BC2_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC3/02_TPM/BC3_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/all_BCs_merged_BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
NSCLC <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC/NSCLC_tpm_Mounim.txt", header = TRUE,  sep = '	', row.names = 1)
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC1/02_TPM/BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/02_TPM/BC2_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC3/02_TPM/BC3_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
write.table(NSCLC, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC/02_TPM/NSCLC_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
library(tidyverse)
library(dplyr)
library(BiocGenerics)
library(stringr)
all_BCs <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/all_BCs_merged_BC-20032024_tpm.txt", header = TRUE,  sep = '	', row.names = 1)
NSCLC <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC/NSCLC_tpm_Mounim.txt", header = TRUE,  sep = '	', row.names = 1) %>%
rownames_to_column("Genes")
BC1_samples <- grep(pattern = "BC1", colnames(all_BCs), value = T)
BC3_samples <- grep(pattern = "BC3", colnames(all_BCs), value = T)
# BC2 needs to be filtered with custom patients (specified in Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv)
custom_BC2_samples <- read.table("/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/Patient_to_include_from_rna_samples_bc2_to_create_custom_cohort.tsv", header = TRUE,  sep = '	', row.names = NULL)
custom_BC2_samples_unique <- unique(custom_BC2_samples$sample) %>% # Remove duplicates
str_replace_all("-",".") %>%
paste0(.,".RNA.01") # Replace and use the same samples name pattern of all
BC2_samples <- grep(pattern = "BC2", colnames(all_BCs), value = T) %>%
intersect(., custom_BC2_samples_unique)
# Save distinct files (with filtered BC2)
BC1 <- all_BCs[BC1_samples] %>%
rownames_to_column("Genes")
write.table(BC1, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC1/02_TPM/BC1_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC2 <- all_BCs[BC2_samples] %>%
rownames_to_column("Genes")
write.table(BC2, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC2/02_TPM/BC2_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
BC3 <- all_BCs[BC3_samples] %>%
rownames_to_column("Genes")
write.table(BC3, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/BC3/02_TPM/BC3_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
write.table(NSCLC, file = "/home/francesco.massaini/Desktop/IMMUCAN_data/NSCLC/02_TPM/NSCLC_TPM_Mounim.txt", quote = F, sep = "\t", row.names = F)
